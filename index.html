<!DOCTYPE html>
<html lang="pt-br">
<head>
<script src="phonegap.js"></script>
<script src="cordova.js"></script>
<title>Onde mesmo?</title>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" href="css/jquery.mobile-1.4.2.min.css" />
<link rel="stylesheet" href="css/jqm-icon-pack-2.0-original.css" />
<script src="js/jquery-1.11.0.min.js"></script>
<script src="js/jquery.mobile-1.4.2.min.js"></script>
<link rel="stylesheet"  href="css/icon-pack-custom.css" />
<link rel="stylesheet"  href="css/estilo.css" />
</head>
<body>
<div data-role="page" id="home" data-url="home" data-theme="b" data-title="Onde Mesmo?">

    <div data-role="header" data-theme="b">
        <img src="imgs/logo.png" alt="Onde Mesmo?">
    </div>

    <div data-role="content">
      <p>Escolha a opção clicando em um dos botões abaixo</p>
		<p><small>Para dicas de precisão, clique em "Instruções", no fim da tela</small></p>
      <br />
      <a href="javascript:getLocation()" class="ui-btn ui-corner-all" onclick="getLocation()">Gravar local</a>
      <a href="javascript:mostrar()" class="ui-btn ui-corner-all" onclick="mostrar()">Mostrar último local</a>
      <br />
      <p id="result"></p>
	  <progress id="progresso" style="display:none;">Coletando suas coordenadas</progress>
    </div>

	<div data-role="footer" data-position="fixed" data-theme="b" id="footer">
		<div id="navgroup">
			<div data-role="controlgroup" data-type="horizontal">
				<a href="#sobre" data-role="button" data-icon="info-circle">Sobre</a>
				<a href="#instrucoes" data-role="button" data-icon="question-circle">Instruções</a>
			</div>
		</div>
	</div>
</div>
  
<div data-role="page" id="sobre" data-url="sobre" data-theme="b" data-title="Sobre - Onde Mesmo?">

    <div data-role="header" data-theme="b">
        <img src="imgs/logo.png" alt="Onde Mesmo?">
    </div>

    <div data-role="content">
      <p><strong>Onde Mesmo?</strong> é um aplicativo em que você grava uma localização, para utilizá-la futuramente.</p>
      <p>Suas principais utilidades são:</p>      
      <ul>
      	<li>Encontrar seu carro no estacionamento</li>
      	<li>Marcar um ponto de encontro, caso se perca de um grupo</li>
      	<li>Gravar a localização de algo para voltar mais tarde</li>
      	<li>etc.</li>
      </ul>
      <br />
      <a href="#home" data-role="button" data-icon="chevron-circle-left">Voltar</a>
      <br />
    </div>

    <div data-role="footer" data-position="fixed" data-theme="b" id="footer">
			<h6>Sobre - Onde mesmo?</h6>
    </div>
</div>

<div data-role="page" id="instrucoes" data-url="instrucoes" data-theme="b" data-title="Instruções - Onde Mesmo?">
    <div data-role="header" data-theme="b">
        <img src="imgs/logo.png" alt="Onde Mesmo?">
    </div>

    <div data-role="content">
      <h2>Importante!</h2>
      <p>Para manter sua privacidade e segurança, <strong>Onde Mesmo?</strong> não tem permissões para alterar nenhum tipo de configuração em seu celular</p>
      <p>Para maior precisão ao guardar sua localização, siga as seguintes instruções:</p>
      <ol> 
      	<li>Vá até as configurações de seu dispositivo</li>
      	<li>Siga até configurações de local</li>
      	<li>Desmarque a opção "Utilizar redes sem fios"</li>
      	<li>Marque a opção "Utilizar satélites GPS"</li>
      </ol>
      <br />
      <h2>Instruções de uso</h2>
      <p>Ao (por exemplo) estacionar seu carro, clique em "Gravar local", e aguarde até que suas coordenadas sejam salvas no dispositivo.</p>
      <p>Após ter as coordenadas salvas, sinta-se livre para fechar o aplicativo, e utilizar seu smartphone livremente.</p>
      <p>No momento de retornar ao local gravado (no caso, seu carro), abra novamente o aplicativo, e clique em "Mostrar último local".</p>
      <p>O aplicativo abrirá um link para o <i>Google Maps</i>. Dependendo da versão de seu sistema Android, podem aparecer opções para qual aplicativo utilizar nesta ação. Caso a opção <i>Mapas</i> esteja disponível, é recomendado que a utilize.</p>
      <p>Ao abrir o aplicativo <i>Mapas</i>, o centro da tela, será o local gravado. Aperte e segure no centro da tela, para <strong>adicionar um marcador</strong>. Após isso, vá na opção <strong>trajeto</strong>, para que seu dispositivo lhe mostre o caminho até o local.</p>
      <p>Caso a opção <i>Mapas</i> não esteja disponível, o link será aberto no navegador de seu dispositivo. Após completamente carregado, clique no botão &#8625; para ter as instruções até o local.</p>
      <address>Em caso de dúvidas: <a href="mailto:contato@zer0.w.pw">contato@zer0.w.pw</a></address>
      <a href="#home" data-role="button" data-icon="chevron-circle-left">Voltar</a>
      <br />
    </div>

    <div data-role="footer" data-position="fixed" data-theme="b" id="footer">
			<h6>Instruções - Onde mesmo?</h6>
    </div>
</div>
<script>
var x=document.getElementById("result");
function mostrar() {
	if (localStorage.getItem("lat")) {
		lat = localStorage.getItem("lat");
		lon = localStorage.getItem("lon");
		abrir();
	}
	else {
		x.style.display="block";
		x.scrollIntoView();
		x.innerHTML="Antes de mostrar sua localização precisamos gravá-la. Clique em \"Gravar local\", e só então, poderemos mostrá-lo.";
	}
}



function onSuccess(position) {
	localStorage.setItem("lat", position.coords.latitude);
	localStorage.setItem("lon", position.coords.longitude);
	x.innerHTML="Suas coordenadas foram salvas com sucesso";
	x.scrollIntoView();
};

function onError(error) {
	x.style.display="block";
	x.scrollIntoView();
	x.innerHTML='Erro: '    + error.code    + '\n' + 'Mensagem: ' + error.message;
}
function getLocation() {
	x.style.display="block";
	x.innerHTML="Aguarde...";
	document.getElementById("progresso").style.display = "block";
	x.scrollIntoView();
	navigator.geolocation.getCurrentPosition(onSuccess, onError, { enableHighAccuracy: true });	
	document.getElementById("progresso").style.display = "none";
}

function abrir() {
navigator.app.loadUrl("http://www.google.com/maps/?q=" + lat + "," + lon, { openExternal:true } );
}


document.addEventListener("backbutton", function(e){
    if($.mobile.activePage.is('#home')){
        e.preventDefault();
        navigator.app.exitApp();
    }
    else {
        navigator.app.backHistory()
    }
}, false);
</script>
</body>
</html>